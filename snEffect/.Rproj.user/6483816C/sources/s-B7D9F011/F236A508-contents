
library(BSgenome.Hsapiens.UCSC.hg19)
getwd()
#setwd("/Users/umaraniperasani/desktop")
uma<-read.table(file = "uma_example.txt",header = T,sep="\t")
uma$chr<-uma$Chrom
uma$start<-uma$Position -1
uma$end<-uma$Position-1
library(dplyr)
del<-uma%>%select(Chrom,Position)
del$Position<-del$Position-1
del
variant<-getSeq(x=BSgenome.Hsapiens.UCSC.hg19,
                names=del$Chrom,
                start=del$Position,
                end=del$Position)
variant<-data.frame(variant)
variant
uma$Variant<-variant$variant
uma$Variant
Ref<-unite(data = uma,col = "Ref",Variant:Ref, sep = "")
uma$Ref<-Ref$Ref
uma$Ref
write.table(uma,"uma_variant_annotated.tsv",quote = F,row.names = F,sep = "\t")
uma